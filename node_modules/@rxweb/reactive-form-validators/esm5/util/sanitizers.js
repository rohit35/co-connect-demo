import { DateProvider } from './date-provider';
import { ApplicationUtil } from './app-util';
import { ReactiveFormConfig } from "./reactive-form-config";
function isNotBlank(value) {
    return (value !== undefined && value !== null && value !== "");
}
function trim(value) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.trim();
    return value;
}
;
function ltrim(value) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(/^\s+/g, '');
    return value;
}
function rtrim(value) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(/\s+$/g, '');
    return value;
}
function blacklist(value, chars) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(new RegExp('[$' + chars + ']+', 'g'), '');
    return value;
}
;
function stripLow(value, keepNewLines) {
    var chars = keepNewLines === true ? '\x00-\x09\x0B\x0C\x0E-\x1F\x7F' : '\x00-\x1F\x7F';
    return blacklist(value, chars);
}
function toBoolean(value, strict) {
    if (isNotBlank(value)) {
        if (strict) {
            return value === '1' || value === 'true';
        }
        return value !== '0' && value !== 'false' && value !== '';
    }
    return value;
}
function toFloat(value) {
    if (isNotBlank(value)) {
        var decimalSymbol = '.';
        if (ReactiveFormConfig && ReactiveFormConfig.number) {
            decimalSymbol = (ReactiveFormConfig.json && ReactiveFormConfig.json.allowDecimalSymbol) ? ReactiveFormConfig.json.allowDecimalSymbol : ReactiveFormConfig.number.decimalSymbol;
        }
        if (decimalSymbol == ',' && typeof value == "string")
            value = value.replace(',', '.');
        if (ApplicationUtil.isNumeric(value))
            return parseFloat(value);
    }
    return null;
}
function toDouble(value) {
    return toFloat(value);
}
function toInt(value, radix) {
    if (isNotBlank(value))
        if (ApplicationUtil.isNumeric(value))
            return parseInt(value, radix || 10);
    return null;
}
function toString(value, radix) {
    if (isNotBlank(value))
        return String(value);
    return value;
}
function whitelist(value, chars) {
    if (isNotBlank(value))
        if (typeof value === "string")
            return value.replace(new RegExp("[^" + chars + "]+", 'g'), '');
    return value;
}
function toDate(value) {
    var dateProvider = new DateProvider();
    if (isNotBlank(value))
        if (typeof value === "string" && dateProvider.isValid(value, {})) {
            value = dateProvider.getDate(value);
            return value;
        }
    return null;
}
function escape(value) {
    if (isNotBlank(value))
        return (value.replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#x27;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/\//g, '&#x2F;')
            .replace(/\\/g, '&#x5C;')
            .replace(/`/g, '&#96;'));
    return value;
}
function prefix(value, text) {
    if (isNotBlank(value))
        return "" + text + value;
    return value;
}
function suffix(value, text) {
    if (isNotBlank(value))
        return "" + value + text;
    return value;
}
function sanitize(value, config) {
    return config.custom(value);
}
export var SANITIZERS = {
    trim: trim,
    ltrim: ltrim,
    rtrim: rtrim,
    blacklist: blacklist,
    stripLow: stripLow,
    toBoolean: toBoolean,
    toDouble: toDouble,
    toFloat: toFloat,
    toInt: toInt,
    'toString': toString,
    whitelist: whitelist,
    toDate: toDate,
    escape: escape,
    prefix: prefix,
    suffix: suffix,
    sanitize: sanitize
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2FuaXRpemVycy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0ByeHdlYi9yZWFjdGl2ZS1mb3JtLXZhbGlkYXRvcnMvIiwic291cmNlcyI6WyJ1dGlsL3Nhbml0aXplcnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFBO0FBQzlDLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxZQUFZLENBQUM7QUFFN0MsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFFNUQsU0FBUyxVQUFVLENBQUMsS0FBVTtJQUMxQixPQUFPLENBQUMsS0FBSyxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssS0FBSyxFQUFFLENBQUMsQ0FBQztBQUNuRSxDQUFDO0FBQ0QsU0FBUyxJQUFJLENBQUMsS0FBVTtJQUNwQixJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUM7UUFDakIsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRO1lBQ3pCLE9BQU8sS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQzVCLE9BQU8sS0FBSyxDQUFDO0FBQ2pCLENBQUM7QUFBQSxDQUFDO0FBRUYsU0FBUyxLQUFLLENBQUMsS0FBVTtJQUNyQixJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUM7UUFDakIsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRO1lBQ3pCLE9BQU8sS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDMUMsT0FBTyxLQUFLLENBQUM7QUFDakIsQ0FBQztBQUVELFNBQVMsS0FBSyxDQUFDLEtBQVU7SUFDckIsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDO1FBQ2pCLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUTtZQUN6QixPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0lBQzFDLE9BQU8sS0FBSyxDQUFDO0FBQ2pC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LElBQVk7SUFDcEMsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDO1FBQ2pCLE9BQU8sS0FBRyxLQUFLLEdBQUcsSUFBTSxDQUFDO0lBQzdCLE9BQU8sS0FBSyxDQUFDO0FBQ2pCLENBQUM7QUFFRCxTQUFTLFFBQVEsQ0FBQyxLQUFVLEVBQUUsTUFBc0I7SUFDaEQsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQy9CLENBQUM7QUFFRCxNQUFNLENBQUMsSUFBTSxVQUFVLEdBQWdDO0lBRW5ELElBQUksRUFBRSxJQUFJO0lBRVYsS0FBSyxFQUFFLEtBQUs7SUFFWixLQUFLLEVBQUUsS0FBSztJQUVaLFNBQVMsRUFBRSxTQUFTO0lBRXBCLFFBQVEsRUFBRSxRQUFRO0lBRWxCLFNBQVMsRUFBRSxTQUFTO0lBRXBCLFFBQVEsRUFBRSxRQUFRO0lBRWxCLE9BQU8sRUFBRSxPQUFPO0lBRWhCLEtBQUssRUFBRSxLQUFLO0lBRVosVUFBVSxFQUFFLFFBQVE7SUFFcEIsU0FBUyxFQUFFLFNBQVM7SUFFcEIsTUFBTSxFQUFFLE1BQU07SUFFZCxNQUFNLEVBQUUsTUFBTTtJQUVkLE1BQU0sRUFBRSxNQUFNO0lBRWQsTUFBTSxFQUFFLE1BQU07SUFFZCxRQUFRLEVBQUUsUUFBUTtDQUNyQixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGF0ZVByb3ZpZGVyIH0gZnJvbSAnLi9kYXRlLXByb3ZpZGVyJ1xyXG5pbXBvcnQgeyBBcHBsaWNhdGlvblV0aWwgfSBmcm9tICcuL2FwcC11dGlsJztcclxuaW1wb3J0IHsgU2FuaXRpemVDb25maWcgfSBmcm9tICcuLi9tb2RlbHMvY29uZmlnL3Nhbml0aXplLWNvbmZpZydcclxuaW1wb3J0IHsgUmVhY3RpdmVGb3JtQ29uZmlnIH0gZnJvbSBcIi4vcmVhY3RpdmUtZm9ybS1jb25maWdcIjtcclxuXHJcbmZ1bmN0aW9uIGlzTm90QmxhbmsodmFsdWU6IGFueSkge1xyXG4gICAgcmV0dXJuICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSBcIlwiKTtcclxufVxyXG5mdW5jdGlvbiB0cmltKHZhbHVlOiBhbnkpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKVxyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUudHJpbSgpO1xyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gbHRyaW0odmFsdWU6IGFueSkge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5yZXBsYWNlKC9eXFxzKy9nLCAnJyk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJ0cmltKHZhbHVlOiBhbnkpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKVxyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUucmVwbGFjZSgvXFxzKyQvZywgJycpO1xyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBibGFja2xpc3QodmFsdWU6IGFueSwgY2hhcnMpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKVxyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUucmVwbGFjZShuZXcgUmVnRXhwKCdbJCcgKyBjaGFycyArICddKycsICdnJyksICcnKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIHN0cmlwTG93KHZhbHVlOiBhbnksIGtlZXBOZXdMaW5lczogYm9vbGVhbikge1xyXG4gICAgbGV0IGNoYXJzOiBTdHJpbmcgPSBrZWVwTmV3TGluZXMgPT09IHRydWUgPyAnXFx4MDAtXFx4MDlcXHgwQlxceDBDXFx4MEUtXFx4MUZcXHg3RicgOiAnXFx4MDAtXFx4MUZcXHg3Ric7XHJcbiAgICByZXR1cm4gYmxhY2tsaXN0KHZhbHVlLCBjaGFycyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvQm9vbGVhbih2YWx1ZTogYW55LCBzdHJpY3Q6IGJvb2xlYW4pIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSkge1xyXG4gICAgICAgIGlmIChzdHJpY3QpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlID09PSAnMScgfHwgdmFsdWUgPT09ICd0cnVlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlICE9PSAnMCcgJiYgdmFsdWUgIT09ICdmYWxzZScgJiYgdmFsdWUgIT09ICcnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0b0Zsb2F0KHZhbHVlOiBhbnkpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSkge1xyXG4gICAgICAgIHZhciBkZWNpbWFsU3ltYm9sID0gJy4nO1xyXG4gICAgICAgIGlmIChSZWFjdGl2ZUZvcm1Db25maWcgJiYgUmVhY3RpdmVGb3JtQ29uZmlnLm51bWJlcikge1xyXG4gICAgICAgICAgICBkZWNpbWFsU3ltYm9sID0gKFJlYWN0aXZlRm9ybUNvbmZpZy5qc29uICYmIFJlYWN0aXZlRm9ybUNvbmZpZy5qc29uLmFsbG93RGVjaW1hbFN5bWJvbCkgPyBSZWFjdGl2ZUZvcm1Db25maWcuanNvbi5hbGxvd0RlY2ltYWxTeW1ib2wgOiBSZWFjdGl2ZUZvcm1Db25maWcubnVtYmVyLmRlY2ltYWxTeW1ib2w7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGVjaW1hbFN5bWJvbCA9PSAnLCcgJiYgdHlwZW9mIHZhbHVlID09IFwic3RyaW5nXCIpXHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UoJywnLCAnLicpO1xyXG4gICAgICAgICAgICBpZiAoQXBwbGljYXRpb25VdGlsLmlzTnVtZXJpYyh2YWx1ZSkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSlcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcbmZ1bmN0aW9uIHRvRG91YmxlKHZhbHVlOiBhbnkpIHtcclxuICAgIHJldHVybiB0b0Zsb2F0KHZhbHVlKVxyXG59XHJcblxyXG5mdW5jdGlvbiB0b0ludCh2YWx1ZTogYW55LCByYWRpeDogbnVtYmVyKSB7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpXHJcbiAgICAgICAgaWYgKEFwcGxpY2F0aW9uVXRpbC5pc051bWVyaWModmFsdWUpKVxyXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQodmFsdWUsIHJhZGl4IHx8IDEwKTtcclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcblxyXG5mdW5jdGlvbiB0b1N0cmluZyh2YWx1ZTogYW55LCByYWRpeDogbnVtYmVyKSB7XHJcbiAgICBpZiAoaXNOb3RCbGFuayh2YWx1ZSkpXHJcbiAgICAgICAgcmV0dXJuIFN0cmluZyh2YWx1ZSk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuZnVuY3Rpb24gd2hpdGVsaXN0KHZhbHVlOiBhbnksIGNoYXJzOiBzdHJpbmcpIHtcclxuICAgIGlmIChpc05vdEJsYW5rKHZhbHVlKSlcclxuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKVxyXG4gICAgICAgICAgICByZXR1cm4gdmFsdWUucmVwbGFjZShuZXcgUmVnRXhwKGBbXiR7Y2hhcnN9XStgLCAnZycpLCAnJyk7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvRGF0ZSh2YWx1ZTogYW55KSB7XHJcbiAgICB2YXIgZGF0ZVByb3ZpZGVyID0gbmV3IERhdGVQcm92aWRlcigpO1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgZGF0ZVByb3ZpZGVyLmlzVmFsaWQodmFsdWUsIHt9KSkge1xyXG4gICAgICAgICAgICB2YWx1ZSA9IGRhdGVQcm92aWRlci5nZXREYXRlKHZhbHVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59XHJcblxyXG5mdW5jdGlvbiBlc2NhcGUodmFsdWU6IHN0cmluZykge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIHJldHVybiAodmFsdWUucmVwbGFjZSgvJi9nLCAnJmFtcDsnKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvXCIvZywgJyZxdW90OycpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC8nL2csICcmI3gyNzsnKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvPC9nLCAnJmx0OycpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC8+L2csICcmZ3Q7JylcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcLy9nLCAnJiN4MkY7JylcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xcXFwvZywgJyYjeDVDOycpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC9gL2csICcmIzk2OycpKTtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gcHJlZml4KHZhbHVlOiBhbnksIHRleHQ6IHN0cmluZykge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIHJldHVybiBgJHt0ZXh0fSR7dmFsdWV9YDtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3VmZml4KHZhbHVlOiBhbnksIHRleHQ6IHN0cmluZykge1xyXG4gICAgaWYgKGlzTm90QmxhbmsodmFsdWUpKVxyXG4gICAgICAgIHJldHVybiBgJHt2YWx1ZX0ke3RleHR9YDtcclxuICAgIHJldHVybiB2YWx1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2FuaXRpemUodmFsdWU6IGFueSwgY29uZmlnOiBTYW5pdGl6ZUNvbmZpZykge1xyXG4gICAgcmV0dXJuIGNvbmZpZy5jdXN0b20odmFsdWUpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBTQU5JVElaRVJTOiB7IFtrZXk6IHN0cmluZ106IEZ1bmN0aW9uIH0gPSB7XHJcblxyXG4gICAgdHJpbTogdHJpbSxcclxuXHJcbiAgICBsdHJpbTogbHRyaW0sXHJcblxyXG4gICAgcnRyaW06IHJ0cmltLFxyXG5cclxuICAgIGJsYWNrbGlzdDogYmxhY2tsaXN0LFxyXG5cclxuICAgIHN0cmlwTG93OiBzdHJpcExvdyxcclxuXHJcbiAgICB0b0Jvb2xlYW46IHRvQm9vbGVhbixcclxuXHJcbiAgICB0b0RvdWJsZTogdG9Eb3VibGUsXHJcblxyXG4gICAgdG9GbG9hdDogdG9GbG9hdCxcclxuXHJcbiAgICB0b0ludDogdG9JbnQsXHJcblxyXG4gICAgJ3RvU3RyaW5nJzogdG9TdHJpbmcsXHJcblxyXG4gICAgd2hpdGVsaXN0OiB3aGl0ZWxpc3QsXHJcblxyXG4gICAgdG9EYXRlOiB0b0RhdGUsXHJcblxyXG4gICAgZXNjYXBlOiBlc2NhcGUsXHJcblxyXG4gICAgcHJlZml4OiBwcmVmaXgsXHJcblxyXG4gICAgc3VmZml4OiBzdWZmaXgsXHJcblxyXG4gICAgc2FuaXRpemU6IHNhbml0aXplXHJcbn0iXX0=